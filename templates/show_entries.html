{% extends "layout.html" %}
{% block body %}
    <div class="container">
        <div class="row">
            <div class="col">
                <div id="columnOne">
                    <form action="{{ url_for('add_income') }}" method="post" class="add-income">
                        <dt>Add Income:
                        <dd><input type="date" name="income_date"></dd>
                        <dd><input type="text" size="30" name="add_income">
                            <select name="incomeCategory">
                                <option value="Salary">Salary</option>
                                <option value="Miscellaneous">Miscellaneous</option>
                            </select></dd>
                        <dd><input type="submit" value="Add Income">
                    </form>
                    <form action ="{{ url_for('filter_income') }}" method="post">
                        <select name="filter_income">
                            <option value="Salary">Salary</option>
                            <option value="Miscellaneous">Miscellaneous</option>
                        </select>
                        <input type="submit" value="Filter Income">
                        <!-- Created the Filter Text feature -->
                    </form>
                </div>
            </div>
            <div class="col">
                <form action ="{{ url_for('add_expense') }}" method="post" class="add-expense">
                    <dt>Add Expense:
                    <dd><input type="date" name="expense_date"></dd>
                    <dd><input type="text" size="30" name="add_expense">
                        <select name="expenseCategory">
                            <option value="Housing">Housing</option>
                            <option value="Transportation">Transportation</option>
                            <option value="Food/Drink">Food/Drink</option>
                            <option value="Miscellaneous">Miscellaneous</option>
                        </select></dd>
                    <dd><input type="submit" value="Add Expense">
                </form>
                <form action ="{{ url_for('filter_expense') }}" method="post">
                    <select name="filter_expense">
                        <option value="Housing">Housing</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Food/Drink">Food/Drink</option>
                        <option value="Miscellaneous">Miscellaneous</option>
                    </select>
                    <input type="submit" value="Filter Expense">
                </form>
                <form action ="{{ url_for('filter_date') }}" method="post">
                    <input type="date" name="filter_date">
                    <input type="submit" value="Filter Date">
                </form>
            </div>

        </div>
        <div id="columnTwo">
            <h2>Net Income: ${{ net }}</h2>
            <div class="row">
                <div class="col">
                    <h3>Incomes</h3>
                    <table id="income_table" class="table table-dark">
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                        <ul class="incomes">
                            {% for incomeEntry in incomes %}
                                <tr>
                                    <td class = "table_category">{{ incomeEntry.category }}</td>
                                    <td class = "table_amount">{{ "{:.2f}".format(incomeEntry.amount) }}</td>
                                    <td class = "table_date">{{ incomeEntry.income_date }}</td>
                                    <td class = "table_edit"><form action ="{{ url_for('edit_income_form') }}" method="get">
                                        <input type="hidden" name="edit_incomes" value="{{ incomeEntry.id }}">
                                        <button type="submit"> Edit Text </button></form></td>
                                    <td class = "table_delete"><form action="{{ url_for('delete_income') }}" method="post">
                                        <input type="hidden" name="income_id" value="{{ incomeEntry.id }}">
                                        <button type="submit" class="del-inc-button">Delete</button>
                                    </form></td>
                                </tr>
                            {% else %}
                                <i>No incomes entered</i>
                            {% endfor %}
                        </ul>
                    </table>
                </div>
                <div class="col">
                    <h3>Expenses</h3>
                    <table id="expense_table" class="table table-dark">
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                        <ul class="expenses">
                            {% for expenseEntry in expenses %}
                                <tr>
                                    <td class = "table_category">{{ expenseEntry.category }}</td>
                                    <td class = "table_amount">{{ "{:.2f}".format(expenseEntry.amount) }}</td>
                                    <td class = "table_date">{{ expenseEntry.expense_date }}</td>
                                    <td class = "table_edit"><form action ="{{ url_for('edit_expense_form') }}" method="get">
                                        <button type="submit" name="edit_expenses" value={{ expenseEntry.id }}> Edit Text </button>
                                    </form></td></td>
                                    <td class = "table_delete"><form action="{{ url_for('delete_expense') }}" method="post">
                                        <input type="hidden" name="expense_id" value="{{ expenseEntry.id }}">
                                        <button type="submit" class="del-exp-button">Delete</button>
                                    </form></td>
                                </tr>
                                </ul>
                            {% else %}
                                <i>No expenses entered</i>
                            {% endfor %}
                    </table>
                </div>
            </div>
        </div>
        <div>
            <h2>Graphs</h2>
            <script type="text/javascript">
                function changeVisibility(desiredGraph){

                    document.getElementById('incomePie').style.visibility='hidden';
                    document.getElementById('expensePie').style.visibility='hidden';
                    document.getElementById('totalPie').style.visibility='hidden';
                    document.getElementById('incomeBar').style.visibility='hidden';
                    document.getElementById('expenseBar').style.visibility='hidden';
                    document.getElementById('totalBar').style.visibility='hidden';

                    document.getElementById(desiredGraph).style.visibility='visible';
                }
            </script>
            <input type="button" value="Income Pie Chart" onClick="changeVisibility('incomePie')">
            <input type="button" value="Expense Pie Chart" onClick="changeVisibility('expensePie')">
            <input type="button" value="Total Pie Chart" onClick="changeVisibility('totalPie')">
            <input type="button" value="Income Bar Graph" onClick="changeVisibility('incomeBar')">
            <input type="button" value="Expense Bar Graph" onClick="changeVisibility('expenseBar')">
            <input type="button" value="Total Bar Graph" onClick="changeVisibility('totalBar')">
            <div class="graphs" id="incomePie">
                <head>
                    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                    <script type="text/javascript">
                        google.charts.load('current', {'packages':['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {

                            var data = google.visualization.arrayToDataTable([
                                ['Incomes', 'Amount'],
                                ['Salary', {{ salaryTotal }}],
                                ['Miscellaneous', {{ miscellaneous1Total }}],
                            ]);

                            var options = {
                                title: 'Income Pie Chart'
                            };

                            var chart = new google.visualization.PieChart(document.getElementById('incomepiechart'));

                            chart.draw(data, options);
                        }
                    </script>
                </head>
                <body>
                <div id="incomepiechart" style="width: 900px; height: 500px;"></div>
                </body>
            </div>

            <div class="graphs" id="expensePie">
                <head>
                    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                    <script type="text/javascript">
                        google.charts.load('current', {'packages':['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {

                            var data = google.visualization.arrayToDataTable([
                                ['Expenses', 'Amount'],
                                ['Housing', {{ housingTotal }}],
                                ['Food/Drink', {{ fooddrinkTotal }}],
                                ['Miscellaneous', {{ miscellaneous2Total }}],
                                ['Transportation', {{ transportationTotal }}]
                            ]);

                            var options = {
                                title: 'Expenses Pie Chart'
                            };

                            var chart = new google.visualization.PieChart(document.getElementById('expensespiechart'));

                            chart.draw(data, options);
                        }
                    </script>
                </head>
                <body>
                <div id="expensespiechart" style="width: 900px; height: 500px;"></div>
                </body>
            </div>

            <div class="graphs" id="totalPie">
                <head>
                    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                    <script type="text/javascript">
                        google.charts.load('current', {'packages':['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {

                            var data = google.visualization.arrayToDataTable([
                                ['Type', 'Amount'],
                                ['Income', {{ incomeTotal }}],
                                ['Expenses', {{ expenseTotal }}]
                            ]);

                            var options = {
                                title: 'Income/Expenses Pie Chart'
                            };

                            var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                            chart.draw(data, options);
                        }
                    </script>
                </head>
                <body>
                <div id="piechart" style="width: 900px; height: 500px;"></div>
                </body>
            </div>

            <div class="graphs" id="totalBar">
                <head>
                    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                    <script type="text/javascript">
                        google.charts.load('current', {'packages':['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {

                            var data = google.visualization.arrayToDataTable([
                                ['Type', 'Amount', { role: "style" } ],
                                ['Income', {{ incomeTotal }}, "red"],
                                ['Expenses', {{ expenseTotal }}, "blue"]
                            ]);

                            var options = {
                                title: 'Income/Expenses Bar Chart'
                            };

                            var chart = new google.visualization.BarChart(document.getElementById('barchart'));

                            chart.draw(data, options);
                        }
                    </script>
                </head>
                <body>
                <div id="barchart" style="width: 900px; height: 500px;"></div>
                </body>
            </div>

            <div class="graphs" id="expenseBar">
                <head>
                    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                    <script type="text/javascript">
                        google.charts.load('current', {'packages':['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {

                            var data = google.visualization.arrayToDataTable([
                                ['Expenses', 'Amount', { role: "style" } ],
                                ['Housing', {{ housingTotal }}, "red"],
                                ['Food/Drink', {{ fooddrinkTotal }}, "blue"],
                                ['Miscellaneous', {{ miscellaneous2Total }}, "green"],
                                ['Transportation', {{ transportationTotal }}, "orange"]
                            ]);

                            var options = {
                                title: 'Expenses Bar Chart'
                            };

                            var chart = new google.visualization.BarChart(document.getElementById('expensesbarchart'));

                            chart.draw(data, options);
                        }
                    </script>
                </head>
                <body>
                <div id="expensesbarchart" style="width: 900px; height: 500px;"></div>
                </body>
            </div>

            <div class="graphs" id="incomeBar">
                <head>
                    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                    <script type="text/javascript">
                        google.charts.load('current', {'packages':['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {

                            var data = google.visualization.arrayToDataTable([
                                ['Incomes', 'Amount', { role: "style" } ],
                                ['Salary', {{ salaryTotal }}, "red"],
                                ['Miscellaneous', {{ miscellaneous1Total }}, "blue"],
                            ]);

                            var options = {
                                title: 'Income Bar Chart'
                            };

                            var chart = new google.visualization.BarChart(document.getElementById('incomebarchart'));

                            chart.draw(data, options);
                        }
                    </script>
                </head>
                <body>
                <div id="incomebarchart" style="width: 900px; height: 500px;"></div>
                </body>
            </div>

        </div>
    </div>
{% endblock %}