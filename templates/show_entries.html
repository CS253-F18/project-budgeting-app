{% extends "layout.html" %}
{% block body %}
    <div class="container">
        <div class="row">
            <div class="col">
                <div id="columnOne">
                    <form action="{{ url_for('add_income') }}" method="post" class="add-income">
                        <dt>Add Income:
                        <dd><input type="date" name="income_date"></dd>
                        <dd><input type="text" size="30" name="add_income">
                            <select name="incomeCategory">
                                <option value="Salary">Salary</option>
                                <option value="Miscellaneous">Miscellaneous</option>
                            </select></dd>
                        <dd><input type="submit" value="Add Income">
                    </form>
                    <form action ="{{ url_for('filter_income') }}" method="post">
                        <select name="filter_income">
                            <option value="Salary">Salary</option>
                            <option value="Miscellaneous">Miscellaneous</option>
                        </select>
                        <input type="submit" value="Filter Income">
                        <!-- Created the Filter Text feature -->
                    </form>
                </div>
            </div>
            <div class="col">
                <form action ="{{ url_for('add_expense') }}" method="post" class="add-expense">
                    <dt>Add Expense:
                    <dd><input type="date" name="expense_date"></dd>
                    <dd><input type="text" size="30" name="add_expense">
                        <select name="expenseCategory">
                            <option value="Housing">Housing</option>
                            <option value="Transportation">Transportation</option>
                            <option value="Food/Drink">Food/Drink</option>
                            <option value="Miscellaneous">Miscellaneous</option>
                        </select></dd>
                    <dd><input type="submit" value="Add Expense">
                </form>
                <form action ="{{ url_for('filter_expense') }}" method="post">
                    <select name="filter_expense">
                        <option value="Housing">Housing</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Food/Drink">Food/Drink</option>
                        <option value="Miscellaneous">Miscellaneous</option>
                    </select>
                    <input type="submit" value="Filter Expense">
                </form>
            </div>

        </div>
        <div id="columnTwo">
            <h2>Net Income: ${{ net }}</h2>
            <div class="row">
                <div class="col">
                    <h3>Incomes</h3>
                    <table id="income_table" class="table table-dark">
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                        <ul class="incomes">
                            {% for incomeEntry in incomes %}
                                <tr>
                                    <td class = "table_category">{{ incomeEntry.category }}</td>
                                    <td class = "table_amount">{{ incomeEntry.amount }}</td>
                                    <td class = "table_date">{{ incomeEntry.income_date }}</td>
                                    <td class = "table_edit"><form action ="{{ url_for('edit_income_form') }}" method="get">
                                        <input type="hidden" name="edit_incomes" value="{{ incomeEntry.id }}">
                                        <button type="submit"> Edit Text </button></form></td>
                                    <td class = "table_delete"><form action="{{ url_for('delete_income') }}" method="post">
                                        <input type="hidden" name="income-id" value="{{ incomeEntry.id }}">
                                        <button type="submit" class="del-inc-button">Delete</button>
                                    </form></td>
                                </tr>
                            {% else %}
                                <i>No incomes entered</i>
                            {% endfor %}
                        </ul>
                    </table>
                </div>
                <div class="col">
                    <h3>Expenses</h3>
                    <table id="expense_table" class="table table-dark">
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                        <ul class="expenses">
                            {% for expenseEntry in expenses %}
                                <tr>
                                    <td class = "table_category">{{ expenseEntry.category }}</td>
                                    <td class = "table_amount">{{ "{:.2f}".format(expenseEntry.amount) }}</td>
                                    <td class = "table_date">{{ expenseEntry.expense_date }}</td>
                                    <td class = "table_edit"><form action ="{{ url_for('edit_expense_form') }}" method="get">
                                        <button type="submit" name="edit_expenses" value={{ expenseEntry.id }}> Edit Text </button>
                                    </form></td></td>
                                    <td class = "table_delete"><form action="{{ url_for('delete_expense') }}" method="post">
                                        <input type="hidden" name="expense-id" value="{{ expenseEntry.id }}">
                                        <button type="submit" class="del-exp-button">Delete</button>
                                    </form></td>
                                </tr>
                                </ul>
                            {% else %}
                                <i>No expenses entered</i>
                            {% endfor %}
                    </table>
                </div>
            </div>
        </div>
        <div>
            <h2>Graphs</h2>
            <head>
                <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                <script type="text/javascript">
                    google.charts.load('current', {'packages':['corechart']});
                    google.charts.setOnLoadCallback(drawChart);

                    function drawChart() {

                        var data = google.visualization.arrayToDataTable([
                            ['Incomes', 'Amount'],
                            ['Salary',     10],
                            ['Miscellaneous', 10],
                        ]);

                        var options = {
                            title: 'Pie Chart'
                        };

                        var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                        chart.draw(data, options);
                    }
                </script>
            </head>
            <body>
            <div id="piechart" style="width: 900px; height: 500px;"></div>
            </body>
            <head>
                <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                <script type="text/javascript">
                    google.charts.load('current', {'packages':['corechart']});
                    google.charts.setOnLoadCallback(drawChart);

                    function drawChart() {
                        var data = google.visualization.arrayToDataTable([
                            ['Month', 'Amount'],
                            ['January',  1000],
                            ['February',  2000],
                            ['March',  500],
                            ['April',  3000]
                        ]);

                        var options = {
                            title: 'Line Chart',
                            curveType: 'function',
                            legend: { position: 'bottom' }
                        };

                        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

                        chart.draw(data, options);
                    }
                </script>
            </head>
            <body>
            <div id="curve_chart" style="width: 900px; height: 500px"></div>
            </body>
        </div>
    </div>
{% endblock %}